<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SMOKE SHAQ STUDIO | ELITE PRO</title>
    <style>
        :root { --gold: #D4AF37; --diamond: #E5E4E2; --black: #050505; --dark-glass: rgba(0,0,0,0.94); }
        
        html, body { 
            margin: 0; padding: 0; min-height: 100vh; width: 100%; 
            background: #000; color: white; font-family: 'Segoe UI', Roboto, sans-serif;
            overflow-x: hidden;
        }

        /* FIXED FULL-SCREEN BACKGROUND SYSTEM */
        .bg-system {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            z-index: -1; pointer-events: none;
        }
        .bg-image {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: url('diamindbackgroud.jpeg') center/cover no-repeat;
            filter: brightness(1.3) contrast(1.1);
        }
        .bg-dust {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: url('golddustbackdrop.png') center/cover no-repeat;
            mix-blend-mode: overlay; opacity: 0.8;
        }
        .bg-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle at center, transparent 0%, rgba(0,0,0,0.85) 70%, #000 100%);
        }

        /* HEADER & PENDANT */
        .header-container {
            width: 100%; position: sticky; top: 0; z-index: 2000;
            background: #000; border-bottom: 2px solid var(--gold);
        }
        .top-rocker { 
            max-width: 1600px; margin: 0 auto; height: 110px;
            display: flex; align-items: center; justify-content: space-between; 
            padding: 0 40px; position: relative;
        }
        
        .logo-group { display: flex; align-items: center; position: relative; }
        .logo-text { color: var(--gold); font-weight: 900; font-size: 1.8rem; letter-spacing: 3px; text-transform: uppercase; z-index: 5; }
        
        /* THE PENDANT - Fixed Positioning */
        .pendant-box {
            position: absolute; left: 260px; top: -10px; height: 160px; pointer-events: none; z-index: 10;
        }
        .pendant-img { height: 100%; filter: drop-shadow(0 15px 25px rgba(0,0,0,0.9)); }

        .auth-status { display: flex; align-items: center; gap: 20px; z-index: 5; }
        .login-btn { background: transparent; border: 1px solid var(--gold); color: var(--gold); padding: 8px 20px; border-radius: 4px; font-weight: 700; cursor: pointer; text-transform: uppercase; font-size: 0.75rem; transition: 0.3s; }
        .login-btn:hover { background: var(--gold); color: black; }

        /* NAVIGATION TABS */
        .nav-bar { background: rgba(0,0,0,0.8); backdrop-filter: blur(10px); padding: 15px 0; border-bottom: 1px solid #222; }
        .page-nav { display: flex; justify-content: center; gap: 40px; }
        .nav-item { cursor: pointer; color: #555; font-weight: 900; font-size: 0.75rem; letter-spacing: 2px; text-transform: uppercase; transition: 0.3s; }
        .nav-item.active { color: var(--gold); text-shadow: 0 0 10px rgba(212,175,55,0.4); }

        /* STUDIO LAYOUT */
        .main-layout { display: flex; justify-content: center; padding: 40px 20px; gap: 30px; max-width: 1600px; margin: 0 auto; min-height: 80vh; }
        .sidebar { width: 220px; }
        .studio-card { flex: 1; max-width: 800px; background: var(--dark-glass); border: 1px solid #222; border-radius: 20px; padding: 40px; box-shadow: 0 0 80px rgba(0,0,0,0.8); }
        
        /* FORM STYLES */
        .cost-badge { background: #000; border-left: 4px solid var(--gold); padding: 12px 20px; margin-bottom: 30px; display: flex; justify-content: space-between; align-items: center; }
        label { color: var(--gold); font-size: 0.65rem; font-weight: 900; display: block; margin-bottom: 8px; text-transform: uppercase; opacity: 0.8; }
        select, textarea, input[type="file"], input[type="range"] { width: 100%; background: #000; border: 1px solid #333; color: white; padding: 16px; border-radius: 10px; margin-bottom: 25px; box-sizing: border-box; font-family: inherit; }
        
        .magic-btn { background: #111; border: 1px solid #444; color: var(--gold); padding: 8px 12px; border-radius: 4px; font-size: 0.6rem; font-weight: 900; cursor: pointer; float: right; margin-top: -42px; position: relative; z-index: 10; }
        .render-btn { width: 100%; padding: 22px; border: none; border-radius: 10px; background: linear-gradient(135deg, #D4AF37, #F9D976, #D4AF37); color: black; font-weight: 900; font-size: 1.1rem; cursor: pointer; text-transform: uppercase; letter-spacing: 3px; box-shadow: 0 10px 30px rgba(212,175,55,0.2); }
        
        #studioOutput { margin-top: 40px; width: 100%; min-height: 450px; background: #000; border-radius: 15px; display: flex; flex-direction: column; align-items: center; justify-content: center; border: 1px solid #111; overflow: hidden; }
        #studioOutput img, #studioOutput video { width: 100%; }

        /* LIVE TALENT FEED */
        .talent-section { padding: 60px 20px; background: #000; text-align: center; border-top: 1px solid #222; }

        /* AI ORB */
        .ai-fab-container { position: fixed; bottom: 30px; right: 30px; display: flex; flex-direction: column; align-items: center; z-index: 3000; }
        .ai-label { background: var(--gold); color: black; font-size: 0.6rem; font-weight: 900; padding: 4px 10px; border-radius: 4px; margin-bottom: 8px; animation: jiggle 2s infinite; }
        .ai-fab { width: 60px; height: 60px; background: var(--gold); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; cursor: pointer; box-shadow: 0 0 30px rgba(212,175,55,0.5); }
        
        @keyframes jiggle { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-5px); } }
        @keyframes pulse { 0% { opacity: 0.3; } 50% { opacity: 1; } 100% { opacity: 0.3; } }
    </style>
</head>
<body>

    <!-- STABLE BACKGROUND SYSTEM -->
    <div class="bg-system">
        <div class="bg-image"></div>
        <div class="bg-dust"></div>
        <div class="bg-overlay"></div>
    </div>

    <!-- STICKY HEADER -->
    <div class="header-container">
        <header class="top-rocker">
            <div class="logo-group">
                <div class="logo-text">SMOKE SHAQ STUDIO</div>
                <div class="pendant-box">
                    <img src="pendant.png" class="pendant-img" alt="Pendant">
                </div>
            </div>
            <div class="auth-status">
                <button id="authBtn" class="login-btn" onclick="openLogin()">SIGN IN / JOIN VIP</button>
                <div id="userPanel" style="display:none; align-items:center; gap:15px; background:rgba(212,175,55,0.1); padding:6px 15px; border-radius:50px; border:1px solid rgba(212,175,55,0.2);">
                    <span id="userHandle" style="font-size: 0.65rem; opacity: 0.5;"></span>
                    <span style="color:var(--gold); font-weight:900; font-size:0.8rem;"><span id="liveCredits">0</span> CREDITS</span>
                </div>
            </div>
        </header>
        <nav class="nav-bar">
            <div class="page-nav">
                <div class="nav-item active" onclick="setMode('img-to-img', this)">Image Studio</div>
                <div class="nav-item" onclick="setMode('img-to-video', this)">Video Engine</div>
                <div class="nav-item" onclick="setMode('lip-sync', this)">Pro Lip Sync</div>
            </div>
        </nav>
    </div>

    <div class="main-layout">
        <aside class="sidebar">
            <div style="background:#000; border:1px solid #222; border-radius:12px; padding:15px; text-align:center;">
                <img src="banner.png" style="width:100%; border-radius:6px; margin-bottom:12px;">
                <a href="https://t.vlmai-3.com/396104/6924?aff_sub5=SF_006OG000004lmDN" style="color:var(--gold); font-weight:900; text-decoration:none; font-size:0.7rem; text-transform:uppercase; letter-spacing:1px;">Join Elite Club</a>
            </div>
        </aside>

        <main class="studio-card">
            <div class="cost-badge">
                <span style="color:#666; font-size:0.7rem; font-weight:900;">UNIT PRODUCTION COST:</span>
                <span style="color:var(--gold); font-weight:900;"><span id="costDisplay">5</span> CREDITS</span>
            </div>

            <label>Studio Engine</label>
            <select id="engineSelect" onchange="updateCost()"></select>

            <label>Reference Asset (Logo or Face)</label>
            <input type="file" id="assetFile">

            <div id="sliderControl">
                <label>Asset Preservation Strength</label>
                <input type="range" id="promptStrength" min="0.1" max="0.9" step="0.05" value="0.85">
            </div>

            <div id="timelineContainer" style="display:none;">
                <label>Voice Script</label>
                <textarea id="scriptText" rows="3" placeholder="Paste dialogue here..."></textarea>
            </div>

            <div style="position:relative;">
                <label>Creative Prompt</label>
                <button class="magic-btn" onclick="pimpPrompt()">✨ Pimp My Prompt</button>
                <textarea id="studioPrompt" rows="4" placeholder="e.g. 3D metallic logo with gold smoke..."></textarea>
            </div>

            <button class="render-btn" onclick="startProduction()">Execute Production</button>

            <div id="studioOutput">
                <p id="standbyText" style="color:#111; font-weight:900; letter-spacing:8px; font-size:1.5rem;">STUDIO STANDBY</p>
                <div id="activeRender" style="display:none; text-align:center;">
                    <div style="color:var(--gold); font-size:1.1rem; font-weight:900; animation: pulse 1.5s infinite;">PROCESSING DIGITAL ASSETS...</div>
                </div>
                <div id="resultContainer"></div>
            </div>
        </main>

        <aside class="sidebar">
            <div style="background:rgba(212,175,55,0.05); border:1px solid var(--gold); border-radius:12px; padding:15px; margin-bottom:20px;">
                <h3 style="color:var(--gold); font-size:0.75rem; margin:0 0 10px 0; text-transform:uppercase;">Elite Guide</h3>
                <div id="dynamicGuide" style="font-size:0.65rem; color:#888; line-height:1.5;"></div>
            </div>
            <div style="border:1px solid #222; border-radius:12px; padding:15px; text-align:center; background:#000;">
                <h4 style="color:var(--gold); margin:0 0 10px 0; font-size:0.75rem;">CREDIT REFILL</h4>
                <a href="https://buy.stripe.com/6oU8wRfbO4wqdQueDE8N200" style="color:white; font-size:0.65rem; text-decoration:none; display:block; border:1px solid #333; padding:8px; border-radius:4px; margin-bottom:10px;">100 Credits - $10</a>
                <a href="https://buy.stripe.com/bJe7sNd3GbYS7s61QS8N201" style="color:black; font-weight:900; background:var(--gold); font-size:0.65rem; text-decoration:none; display:block; padding:8px; border-radius:4px;">550 Credits - $45</a>
            </div>
        </aside>
    </div>

    <div class="talent-section">
        <h2 style="color:var(--gold); letter-spacing:10px; margin-bottom:40px; text-transform:uppercase; font-size:1.2rem;">LIVE TALENT FEED</h2>
        <div style="max-width:1200px; margin:0 auto;">
            <script src="https://crxcr2.com/cams-widget-ext/script?landing_id=%7Boffer_url_id%7D&genders=f&providers=chaturbate%2Cimlive&skin=1&containerAlignment=center&cols=4&rows=1&number=4&background=transparent&useFeed=1&animateFeed=1&smoothAnimation=1&ratio=1&verticalSpace=10px&horizontalSpace=10px&colorFilter=0&colorFilterStrength=0&AuxiliaryCSS=%0A&lang=en&token=e698f390-051d-11f1-8e58-ffbaf8ca8890&api_key=8389c2842c3c186e10c4f3f6db2a1d92304aff4d6d1e8e47f25b9627f078d33a"></script>
        </div>
    </div>

    <div class="ai-fab-container">
        <div class="ai-label">PROMPT HELP</div>
        <div class="ai-fab" onclick="toggleChat()">✨</div>
    </div>

    <!-- JS Logic remains same but optimized for stability -->
    <script>
        let currentMode = 'img-to-img';
        let userEmail = localStorage.getItem('studio_email') || null;
        let userCredits = 0;

        const guides = {
            'img-to-img': `<b>IMAGE TIPS:</b><br>1. Use 0.85 Preservation for exact logos.<br>2. Use the word 'Logo' for branding results.`,
            'img-to-video': `<b>VIDEO TIPS:</b><br>1. Mention "camera dolly forward" for motion.`,
            'lip-sync': `<b>LIP SYNC TIPS:</b><br>1. Best with clear headshot photos.`
        };

        const modelLibrary = {
            'img-to-img': [{ id: 'flux-pro', name: 'FLUX 1.1 PRO', cost: 5 }],
            'img-to-video': [{ id: 'kling-video', name: 'KLING 2.5', cost: 15 }],
            'lip-sync': [{ id: 'omni-human', name: 'OMNI-HUMAN', cost: 20 }]
        };

        function setMode(mode, el) {
            currentMode = mode;
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            el.classList.add('active');
            document.getElementById('timelineContainer').style.display = (mode === 'lip-sync') ? 'block' : 'none';
            document.getElementById('sliderControl').style.display = (mode === 'img-to-img') ? 'block' : 'none';
            document.getElementById('dynamicGuide').innerHTML = guides[mode];
            updateEngineDropdown();
        }

        function updateEngineDropdown() {
            const select = document.getElementById('engineSelect');
            select.innerHTML = modelLibrary[currentMode].map(m => `<option value="${m.id}">${m.name}</option>`).join('');
            updateCost();
        }

        function updateCost() {
            const select = document.getElementById('engineSelect');
            const model = modelLibrary[currentMode].find(m => m.id === select.value);
            if(model) document.getElementById('costDisplay').innerText = model.cost;
        }

        function loginUI(email) {
            document.getElementById('authBtn').style.display = 'none';
            document.getElementById('userPanel').style.display = 'flex';
            document.getElementById('userHandle').innerText = email;
        }

        async function updateCredits() {
            if(!userEmail) return;
            try {
                const res = await fetch(`/api/credits?email=${userEmail}`);
                const data = await res.json();
                userCredits = data.credits || 0;
                document.getElementById('liveCredits').innerText = userCredits;
            } catch(e) {}
        }

        function pimpPrompt() {
            const area = document.getElementById('studioPrompt');
            let base = area.value || "A professional production";
            let enhanced = "";
            if (base.toLowerCase().includes('logo')) {
                enhanced = `${base}, 3D branding, metallic, volumetric smoke, 8k, photorealistic --no human --no face`;
            } else {
                enhanced = `${base}, hyper-realistic skin, professional studio lighting, 8k, cinematic depth of field`;
            }
            area.value = enhanced;
        }

        // Initialize
        document.getElementById('dynamicGuide').innerHTML = guides['img-to-img'];
        updateEngineDropdown();
        if(userEmail) { loginUI(userEmail); updateCredits(); }
    </script>
</body>
</html>
